trigger:
- custodia/agent

jobs:
- job:
  displayName: DevOps Pipeline Agent Image Build
  pool:
    vmImage: 'vs2017-win2016'
  variables:
  - group: packer-image-build-variables

  steps:
  - task: Packer@1
    inputs:
      connectedServiceType: 'azure'
      azureSubscription: 'BizSpark (Pipelines Service Principal)'
      templatePath: '$(System.DefaultWorkingDirectory)/images/win/simple-windows2016.json'
      command: 'build'
      force: true  

  # - task: PackerBuild@1
  #   inputs:
  #     templateType: 'custom'
  #     customTemplateLocation: '$(System.DefaultWorkingDirectory)/images/win/simple-windows2016.json'
  #     packerVersion: '1.7.0'
